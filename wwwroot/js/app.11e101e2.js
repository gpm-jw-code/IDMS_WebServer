(function(){var e={6700:function(e,t,a){var s={"./af":3906,"./af.js":3906,"./ar":902,"./ar-dz":3853,"./ar-dz.js":3853,"./ar-kw":299,"./ar-kw.js":299,"./ar-ly":6825,"./ar-ly.js":6825,"./ar-ma":6379,"./ar-ma.js":6379,"./ar-sa":7700,"./ar-sa.js":7700,"./ar-tn":2059,"./ar-tn.js":2059,"./ar.js":902,"./az":6043,"./az.js":6043,"./be":7936,"./be.js":7936,"./bg":4078,"./bg.js":4078,"./bm":4014,"./bm.js":4014,"./bn":9554,"./bn-bd":7114,"./bn-bd.js":7114,"./bn.js":9554,"./bo":6529,"./bo.js":6529,"./br":5437,"./br.js":5437,"./bs":9647,"./bs.js":9647,"./ca":9951,"./ca.js":9951,"./cs":6113,"./cs.js":6113,"./cv":7965,"./cv.js":7965,"./cy":5858,"./cy.js":5858,"./da":3515,"./da.js":3515,"./de":2831,"./de-at":6263,"./de-at.js":6263,"./de-ch":1127,"./de-ch.js":1127,"./de.js":2831,"./dv":4510,"./dv.js":4510,"./el":8616,"./el.js":8616,"./en-au":4595,"./en-au.js":4595,"./en-ca":3545,"./en-ca.js":3545,"./en-gb":9609,"./en-gb.js":9609,"./en-ie":3727,"./en-ie.js":3727,"./en-il":3302,"./en-il.js":3302,"./en-in":6305,"./en-in.js":6305,"./en-nz":9128,"./en-nz.js":9128,"./en-sg":4569,"./en-sg.js":4569,"./eo":650,"./eo.js":650,"./es":6358,"./es-do":4214,"./es-do.js":4214,"./es-mx":8639,"./es-mx.js":8639,"./es-us":232,"./es-us.js":232,"./es.js":6358,"./et":7279,"./et.js":7279,"./eu":5515,"./eu.js":5515,"./fa":7981,"./fa.js":7981,"./fi":7090,"./fi.js":7090,"./fil":9208,"./fil.js":9208,"./fo":2799,"./fo.js":2799,"./fr":3463,"./fr-ca":2213,"./fr-ca.js":2213,"./fr-ch":2848,"./fr-ch.js":2848,"./fr.js":3463,"./fy":1468,"./fy.js":1468,"./ga":8163,"./ga.js":8163,"./gd":2898,"./gd.js":2898,"./gl":6312,"./gl.js":6312,"./gom-deva":682,"./gom-deva.js":682,"./gom-latn":9178,"./gom-latn.js":9178,"./gu":5009,"./gu.js":5009,"./he":2795,"./he.js":2795,"./hi":7009,"./hi.js":7009,"./hr":6506,"./hr.js":6506,"./hu":9565,"./hu.js":9565,"./hy-am":3864,"./hy-am.js":3864,"./id":5626,"./id.js":5626,"./is":6649,"./is.js":6649,"./it":151,"./it-ch":5348,"./it-ch.js":5348,"./it.js":151,"./ja":9830,"./ja.js":9830,"./jv":3751,"./jv.js":3751,"./ka":3365,"./ka.js":3365,"./kk":5980,"./kk.js":5980,"./km":9571,"./km.js":9571,"./kn":5880,"./kn.js":5880,"./ko":6809,"./ko.js":6809,"./ku":6773,"./ku.js":6773,"./ky":5505,"./ky.js":5505,"./lb":553,"./lb.js":553,"./lo":1237,"./lo.js":1237,"./lt":1563,"./lt.js":1563,"./lv":1057,"./lv.js":1057,"./me":6495,"./me.js":6495,"./mi":3096,"./mi.js":3096,"./mk":3874,"./mk.js":3874,"./ml":6055,"./ml.js":6055,"./mn":7747,"./mn.js":7747,"./mr":7113,"./mr.js":7113,"./ms":8687,"./ms-my":7948,"./ms-my.js":7948,"./ms.js":8687,"./mt":4532,"./mt.js":4532,"./my":4655,"./my.js":4655,"./nb":6961,"./nb.js":6961,"./ne":2512,"./ne.js":2512,"./nl":8448,"./nl-be":2936,"./nl-be.js":2936,"./nl.js":8448,"./nn":9031,"./nn.js":9031,"./oc-lnc":5174,"./oc-lnc.js":5174,"./pa-in":118,"./pa-in.js":118,"./pl":3448,"./pl.js":3448,"./pt":3518,"./pt-br":2447,"./pt-br.js":2447,"./pt.js":3518,"./ro":817,"./ro.js":817,"./ru":262,"./ru.js":262,"./sd":8990,"./sd.js":8990,"./se":3842,"./se.js":3842,"./si":7711,"./si.js":7711,"./sk":756,"./sk.js":756,"./sl":3772,"./sl.js":3772,"./sq":6187,"./sq.js":6187,"./sr":732,"./sr-cyrl":5713,"./sr-cyrl.js":5713,"./sr.js":732,"./ss":9455,"./ss.js":9455,"./sv":9770,"./sv.js":9770,"./sw":959,"./sw.js":959,"./ta":6459,"./ta.js":6459,"./te":5302,"./te.js":5302,"./tet":7975,"./tet.js":7975,"./tg":1294,"./tg.js":1294,"./th":2385,"./th.js":2385,"./tk":4613,"./tk.js":4613,"./tl-ph":8668,"./tl-ph.js":8668,"./tlh":8190,"./tlh.js":8190,"./tr":4506,"./tr.js":4506,"./tzl":3440,"./tzl.js":3440,"./tzm":9852,"./tzm-latn":2350,"./tzm-latn.js":2350,"./tzm.js":9852,"./ug-cn":730,"./ug-cn.js":730,"./uk":99,"./uk.js":99,"./ur":2100,"./ur.js":2100,"./uz":6002,"./uz-latn":6322,"./uz-latn.js":6322,"./uz.js":6002,"./vi":4207,"./vi.js":4207,"./x-pseudo":4674,"./x-pseudo.js":4674,"./yo":570,"./yo.js":570,"./zh-cn":3644,"./zh-cn.js":3644,"./zh-hk":2591,"./zh-hk.js":2591,"./zh-mo":9503,"./zh-mo.js":9503,"./zh-tw":8080,"./zh-tw.js":8080};function o(e){var t=n(e);return a(t)}function n(e){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}o.keys=function(){return Object.keys(s)},o.resolve=n,e.exports=o,o.id=6700},7449:function(e,t,a){"use strict";var s=a(9242),o=a(936),n=a(2152),i=a(2748),l=(a(4415),a(3396)),r=a(7139);const d={id:"breadcrumb",sticky:""},c={class:"navbar navbar-expand-sm navbar-dark bg-dark sticky"},u={class:"container-fluid"},h=(0,l._)("a",{class:"navbar-brand",style:{position:"relative",left:"-30px"}},"GPM",-1),m={class:"navbar-toggler",type:"button"},p=(0,l._)("span",{class:"navbar-toggler-icon"},null,-1),w=[p],g={class:"collapse navbar-collapse",id:"navbar"},_={class:"navbar-nav"};function y(e,t,a,s,o,n){const i=(0,l.up)("router-link"),p=(0,l.up)("router-view"),y=(0,l.Q2)("b-toggle");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",d,[(0,l._)("nav",c,[(0,l._)("div",u,[h,(0,l.wy)(((0,l.wg)(),(0,l.iD)("button",m,w)),[[y,"navbar"]]),(0,l._)("div",g,[(0,l._)("div",_,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.routes,(e=>((0,l.wg)(),(0,l.j4)(i,{key:e.path,to:e.path},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.name),1)])),_:2},1032,["to"])))),128))])])])])]),(0,l.Wm)(p,null,{default:(0,l.w5)((({Component:e})=>[((0,l.wg)(),(0,l.j4)(l.Ob,null,[((0,l.wg)(),(0,l.j4)((0,l.LL)(e)))],1024))])),_:1})],64)}var f={get host(){return window.location.protocol+"//"+window.location.host},get websocket_host(){return this.host.replace("http","ws")},get idms_websocket_host(){return window.location.protocol.replace("http","ws")+"//"+window.location.hostname+":44332"},mode:"gpm"};console.info(window.location.protocol.replace("http","ws")+"//"+window.location.hostname+":44332"),console.info(f.host),console.info("websocket_host",f.websocket_host),console.info("idms_websocket_host",f.idms_websocket_host);var b=a(2483);const v={class:"home"};function S(e,t,a,s,o,n){const i=(0,l.up)("ssmManager");return(0,l.wg)(),(0,l.iD)("div",v,[(0,l.Wm)(i)])}const D={style:{"padding-top":"80px"}},k={class:"table my_table"},C=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",{class:"alway-show-col",scope:"col",width:"5%"},"#"),(0,l._)("th",{class:"alway-show-col",scope:"col"},"IP"),(0,l._)("th",{class:"alway-show-col",scope:"col"},"PORT"),(0,l._)("th",{class:"alway-show-col",scope:"col",width:"10%"},"量測範圍"),(0,l._)("th",{class:"alway-show-col",scope:"col",width:"20%"},"更新時間"),(0,l._)("th",{class:"alway-show-col",scope:"col",width:"20%"},"狀態"),(0,l._)("th",{class:"opt-region-div",scope:"col",width:"5%"}),(0,l._)("th",{class:"opt-region-div",scope:"col",width:"5%"})])],-1),x={key:0},I=(0,l._)("td",{colspan:"7",style:{color:"grey"}},"Empty",-1),W=[I];function T(e,t,a,s,o,n){const i=(0,l.up)("ManagerOperatesVue"),r=(0,l.up)("el-divider"),d=(0,l.up)("ModuleState");return(0,l.wg)(),(0,l.iD)("div",D,[(0,l.Wm)(i,{onOnModuleAdd:n.ModuleAddingHandle},null,8,["onOnModuleAdd"]),(0,l.Wm)(r),(0,l._)("table",k,[C,(0,l._)("tbody",null,[0==o.ModuleList.length?((0,l.wg)(),(0,l.iD)("tr",x,W)):((0,l.wg)(!0),(0,l.iD)(l.HY,{key:1},(0,l.Ko)(o.ModuleList,(e=>((0,l.wg)(),(0,l.j4)(d,{key:e.endPoint,moduleInfo:e,onOnModuleRemove:n.ModuleRemovedHandle},null,8,["moduleInfo","onOnModuleRemove"])))),128))])])])}var j=a(6265),P=a.n(j);async function M(){var e=await P().get("api/SystemSettings");return 200==e.status?e.data:{}}async function A(e){var t=await P().post("api/SystemSettings",e);return 200==t.status?t.data:{}}async function E(){var e=await P().get("api/ModuleManager/ModuleList");return 200==e.status?e.data:[]}async function z(){var e=await P().get("api/AppState/GetAppStates");return e.data}async function R(e){var t=await P().post("api/ModuleManager/RemoveModule",e);return t.data}async function L(e,t){var a=await P().post("api/ModuleManager/AddModule",{ip:e,port:t});return a.data}async function H(e="127.0.0.1",t=231,a=2){var s=await P().post("api/ModuleManager/SettingMeasureRange",{Range:a,ip:e,port:t}).catch((e=>{console.info(e)}));return s.data}async function U(e){var t=await P().get(`api/TcpClient/KickOut/${e}`);return t.data}P().defaults.baseURL=f.host;var N=a(6797),V=a.n(N),O=a(2482);class F{constructor(e,t){(0,O.Z)(this,"ip",""),(0,O.Z)(this,"port",-1),(0,O.Z)(this,"index",0),this.ip=e,this.port=t}}var Q=F;const $=["id"];function B(e,t,a,s,o,n){const i=(0,l.Q2)("loading");return(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",{class:"gpm-chart",style:(0,r.j5)(o.chart_style)},[(0,l._)("canvas",{class:"h-100",onClick:t[0]||(t[0]=(...e)=>n.ClickChartHandel&&n.ClickChartHandel(...e)),id:a.chart_id},null,8,$)],4)),[[i,o.loading]])}var Y=a(4531),Z=a.n(Y),q={components:{},props:{chart_id:{type:String,default:"dchart"},title:{type:String,default:"Title"},xAxisLabel:{type:String,default:"時間"},yAxisLabel:{type:String,default:"YLabel"},xlabelUseTimeFormat:{type:Boolean,default:!0}},data(){return{loading:!1,Rendering:!1,chart_style:{backgroundColor:"#202020",border:"1px solid grey",margin:"3px",borderRadius:"4px"},chartInstance:{data:{labels:[],datasets:[]},update:()=>{}},options:{responsive:!0,maintainAspectRatio:!1,lineTension:0,tooltips:{mode:"index",intersect:!0},layout:{padding:{bottom:10,top:10}},title:{display:!0,text:this.title,fontSize:14,fontColor:"white"},scales:{yAxes:[{gridLines:{color:"#313131"},ticks:{beginAtZero:!0,padding:20,fontColor:"white",autoskip:!0,maxTicksLimit:10,min:0,max:100},scaleLabel:{display:!0,labelString:this.yAxisLabel,fontSize:16,fontColor:"white"}}],xAxes:[{type:"time",time:{unit:"second",displayFormats:{day:"YYYY-MM-DD HH:mm:ss",hour:"YYYY-MM-DD HH:mm:ss",second:"YY/MM/DD HH:mm"}},gridLines:{color:"#313131"},ticks:{autoskip:!0,autoSkipPadding:33,maxRotation:0,minRotation:0,fontColor:"white"},scaleLabel:{display:!0,labelString:this.xAxisLabel,fontSize:16,fontColor:"white"},getValueForPixel(){}}]},annotation:{drawTime:"afterDraw",annotations:[{type:"line",id:"line",mode:"horizontal",scaleID:"y-axis-0",value:2,borderWidth:2,borderColor:"red"}]},legend:{display:!0}},xlabels:[],datasets:[],datasetsVisible:[],isDark:!0,currentTheme:"dark",colors:["blue","green","red","orange","pink","grey","black","seagreen"]}},methods:{test(){this.chartInstance.setDatasetVisibility(1,!1),this.chartInstance.update()},ThemeChange(){this.currentTheme="dark"==this.currentTheme?"light":"dark",this.chart_style.backgroundColor="dark"==this.currentTheme?"#202020":"white",this.chart_style.border="dark"==this.currentTheme?"1px solid grey":"1px solid white",this.isDark="dark"==this.currentTheme,this.chartInstance.options.title.fontColor=this.chartInstance.options.scales.xAxes[0].ticks.fontColor=this.chartInstance.options.scales.xAxes[0].scaleLabel.fontColor=this.chartInstance.options.scales.yAxes[0].ticks.fontColor=this.chartInstance.options.scales.yAxes[0].scaleLabel.fontColor="dark"==this.currentTheme?"white":"black",this.chartInstance.update()},ClickChartHandel(){},ChartInit(){this.xlabelUseTimeFormat||(this.options.scales.xAxes[0].type="category");const e=document.getElementById(this.chart_id);this.chartInstance=new(Z())(e,{type:"line",data:{labels:[],datasets:[]},options:this.options}),this.chartInstance.options.animation=!1},async UpdatePreviewChart(e=[],t=[]){this.$refs["preview_chart"].UpdatePreviewChart(e,t)},async UpdateChart(e=[],t=[{label:"",data:[0],borderColor:"blue",borderWidth:1}],a=!1){try{console.info("開始渲染"),a&&(this.loading=!0);var s=Object.values(e),o=[];for(let e=0;e<t.length;e++){const a=t[e];void 0==this.datasetsVisible.find((e=>e.label==a.label))&&this.datasetsVisible.push({label:a.label,visible:!0,color:a.borderColor}),this.datasetsVisible.find((e=>e.label==a.label)).visible&&o.push({label:a.label,data:Object.values(a.data),borderColor:void 0!=a.borderColor?a.borderColor:this.colors[e],borderWidth:void 0!=a.borderWidth?a.borderWidth:1,fill:!1,pointStyle:"none",pointRadius:0,lineTension:0})}await this.RenderData(s,o),setTimeout((()=>{this.loading=!1}),100)}catch(n){return"err"}},ShowPreviewChart(){this.$refs["preview_chart"].ShowPreviewChart()},HidePreviewChart(){this.$refs["preview_chart"].HidePreviewChart()},FeedData(e=[],t=[{label:"",data:-1,borderColor:"blue",borderWidth:1}]){0!=t.length&&void 0!=e&&(this.xlabels.push(e),t.forEach((e=>{var t=this.datasets.find((t=>t.label==e.label));t?t.data.push(e.data):this.datasets.push({label:e.label,data:[e.data],backgroundColor:"",borderColor:e.borderColor?e.borderColor:"blue",borderWidth:e.borderWidth?e.borderWidth:1,fill:!1,pointStyle:"none",pointRadius:0,lineTension:0})})),this.DataFIFO(),this.RenderData())},Clear(){this.datasetsVisible=[],this.RenderData([],[])},async RenderData(e,t){await new Promise(((a,s)=>{try{this.chartInstance.data.datasets=t,this.chartInstance.data.labels=e,this.chartInstance.update(),console.info("結束渲染"),a()}catch(o){console.error(o),this.ChartInit(),s(o)}}))},DataFIFO(){this.xlabels.length>50&&(this.xlabels.splice(0,1),this.datasets.forEach((e=>{e.data.splice(0,1)})))}},computed:{currentDataSet(){var e=[];return this.chartInstance.data.datasets.forEach((t=>{e.push(t.data)})),{labels:this.chartInstance.data.labels,datas:e}},TimeWindowDom(){return document.getElementById("time-window")}},mounted(){this.ChartInit()},created(){}},G=a(89);const J=(0,G.Z)(q,[["render",B]]);var K=J,X=a(2655),ee=a(7178);const te={class:"module-state-tr"},ae={class:"pt-2"},se={class:"pt-2"},oe={key:0,class:"spinner-border",role:"status"},ne=(0,l._)("span",{class:"visually-hidden"},null,-1),ie=[ne],le={class:"dropdown"},re={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},de=["onClick"],ce={class:"spinner-border",role:"status"},ue=(0,l._)("span",{class:"visually-hidden"},null,-1),he=[ue],me={style:{"text-align":"center"}},pe={class:"spinner-border",role:"status"},we=(0,l._)("span",{class:"visually-hidden"},null,-1),ge=[we],_e={class:"opt-region-div"},ye=(0,l.Uk)("More"),fe={class:"opt-region-div"},be=(0,l.Uk)("Remove"),ve={colspan:"8"},Se={class:"row g-1"},De={class:"col-lg-6 f-table"},ke=(0,l._)("div",{class:"title"},"特徵值",-1),Ce={class:"table"},xe=(0,l._)("tr",{class:"columns"},[(0,l._)("th",{scope:"col",class:"col-2"}),(0,l._)("th",{scope:"col",class:"col-3"},"X"),(0,l._)("th",{scope:"col",class:"col-3"},"Y"),(0,l._)("th",{scope:"col",class:"col-3"},"Z")],-1),Ie=(0,l._)("td",{class:"f-name"},"P2P",-1),We=(0,l._)("td",{class:"f-name"},"RMS",-1),Te=(0,l._)("td",{class:"f-name"},"振動能量",-1),je={class:"col-lg-6"},Pe=(0,l._)("div",{class:"title"},"Raw Data",-1),Me={components:{GPMChart:K},data(){return{SensingData:{AccData:{X:[],Y:[],Z:[]},FFTData:{X:[],Y:[],Z:[],FreqVec:[],Freq_Resolution:1},Features:{AccP2P:{X:-1,Y:-1,Z:-1},AccRMS:{X:-1,Y:-1,Z:-1},VibrationEnergy:{X:-1,Y:-1,Z:-1}},measureRange:"",ErrorCode:-1,RecieveTime:""},ConnectionState:"",ShowMore:!1,gRange:2,gRangeSetting:!1,connectState_ws:null,data_ws:null}},computed:{DataUpdateTime(){return V()(this.SensingData.RecieveTime).format("yyyy-MM-DD HH:mm:ss")},toggleID(){return"toggle"+this.moduleInfo.ip.replaceAll(".","_")+this.moduleInfo.port},chart(){return this.$refs[this.moduleInfo.ip]}},props:{moduleInfo:{type:Q,default:()=>new Q("127.0.0.1",6969)}},methods:{WsSensingDataHandle(e){var t=JSON.parse(e);this.SensingData=JSON.parse(t.Message),this.gRange=this.SensingData.measureRange.replace("G","");var a=[{label:"X",data:this.SensingData.AccData.X,borderColor:"rgb(26, 123, 255)"},{label:"Y",data:this.SensingData.AccData.Y,borderColor:"rgb(87, 185, 120)"},{label:"Z",data:this.SensingData.AccData.Z,borderColor:"rgb(217, 94, 94)"}],s=a[0].data.length,o=[];for(let n=0;n<s;n++)o.push(n+1);this.chart.UpdateChart(o,a,!1,!1)},CreateChartingData(){},WsConnectStateDataHandle(e){var t=JSON.parse(e);this.ConnectionState=t.Message},MoreBtnClickHandle(){this.ShowMore=!this.ShowMore},async ModifyGRange(e){this.gRangeSetting=!0;var t=await H(this.moduleInfo.ip,this.moduleInfo.port,e);console.info(t),t.errorCode,setTimeout((()=>{this.gRangeSetting=!1}),500)}},mounted(){this.gRange=this.moduleInfo.measureRage,this.data_ws=new WebSocket(`${f.websocket_host}/module_data/${this.moduleInfo.endPoint}`),this.data_ws.onopen=()=>{console.info(`${this.moduleInfo.endPoint} data ws 已連接.`)},this.data_ws.onmessage=e=>{this.WsSensingDataHandle(e.data)},this.connectState_ws=new WebSocket(`${f.websocket_host}/module_state/${this.moduleInfo.endPoint}`),this.connectState_ws.onopen=()=>{console.info(`${this.moduleInfo.endPoint} state ws 已連接.`)},this.connectState_ws.onmessage=e=>{this.WsConnectStateDataHandle(e.data)}},unmounted(){this.data_ws.close(),this.connectState_ws.close()}};var Ae=Object.assign(Me,{__name:"ModuleState",emits:["OnModuleRemove"],setup(e,{emit:t}){async function a(e){X.T.confirm(`確定要移除 ${e.endPoint}?`,"Warning",{confirmButtonText:"確定",cancelButtonText:"取消"}).then((async()=>{var a=await R(e);a&&(t("OnModuleRemove",{}),(0,ee.z8)({type:"info",message:`${e.endPoint} 刪除成功`}))}))}return(t,o)=>{const n=(0,l.up)("b-button"),i=(0,l.up)("b-collapse"),d=(0,l.Q2)("b-toggle");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("tr",te,[(0,l.wy)(((0,l.wg)(),(0,l.iD)("th",null,[(0,l._)("div",null,(0,r.zw)(e.moduleInfo.index),1)])),[[d,t.toggleID]]),(0,l.wy)(((0,l.wg)(),(0,l.iD)("td",null,[(0,l._)("div",ae,(0,r.zw)(e.moduleInfo.ip),1)])),[[d,t.toggleID]]),(0,l.wy)(((0,l.wg)(),(0,l.iD)("td",null,[(0,l._)("div",se,(0,r.zw)(e.moduleInfo.port),1)])),[[d,t.toggleID]]),(0,l._)("td",null,[t.gRangeSetting?((0,l.wg)(),(0,l.iD)("div",oe,ie)):(0,l.kq)("",!0),(0,l.Wm)(s.uT,{name:"el-zoom-in-bottom"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l._)("div",le,[(0,l.Wm)(n,{class:(0,r.C_)(["dropdown-toggle measure-range-button",603==t.SensingData.ErrorCode?"disabled":""]),variant:"dark",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false",size:"md"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(t.gRange)+"G",1)])),_:1},8,["class"]),(0,l._)("ul",re,[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)([2,4,8,16],(e=>(0,l._)("li",{key:e},[(0,l._)("u",{class:"dropdown-item",onClick:a=>t.ModifyGRange(e)},(0,r.zw)(e)+"G",9,de)]))),64))])],512),[[s.F8,!(t.gRangeSetting|""==e.moduleInfo.measureRange)]])])),_:1})]),(0,l.wy)(((0,l.wg)(),(0,l.iD)("td",null,[(0,l.wy)((0,l._)("div",ce,he,512),[[s.F8,""==t.SensingData.RecieveTime]]),(0,l.Wm)(s.uT,{name:"el-zoom-in-bottom"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l._)("div",{class:"pt-2"},(0,r.zw)(t.DataUpdateTime),513),[[s.F8,""!=t.SensingData.RecieveTime]])])),_:1})])),[[d,t.toggleID]]),(0,l.wy)(((0,l.wg)(),(0,l.iD)("td",me,[(0,l.wy)((0,l._)("div",pe,ge,512),[[s.F8,-1==t.SensingData.ErrorCode]]),(0,l.Wm)(s.uT,{name:"el-zoom-in-bottom"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l._)("div",{class:"connection-label",style:(0,r.j5)({backgroundColor:0==t.SensingData.ErrorCode?"seagreen":"red"})},(0,r.zw)(0==t.SensingData.ErrorCode?"CONNECTED":t.SensingData.ErrorCode),5),[[s.F8,-1!=t.SensingData.ErrorCode]])])),_:1})])),[[d,t.toggleID]]),(0,l._)("td",_e,[(0,l.wy)(((0,l.wg)(),(0,l.j4)(n,{size:"sm",variant:"light",squared:""},{default:(0,l.w5)((()=>[ye])),_:1})),[[d,t.toggleID]])]),(0,l._)("td",fe,[(0,l.Wm)(n,{size:"sm",variant:"danger",squared:"",onClick:o[0]||(o[0]=t=>a(e.moduleInfo))},{default:(0,l.w5)((()=>[be])),_:1})])]),(0,l._)("tr",null,[(0,l._)("td",ve,[(0,l.Wm)(i,{ref:"collapse",class:"more-info-collapse",id:t.toggleID},{default:(0,l.w5)((()=>[(0,l._)("div",Se,[(0,l._)("div",De,[ke,(0,l._)("table",Ce,[xe,(0,l._)("tbody",null,[(0,l._)("tr",null,[Ie,(0,l._)("td",null,(0,r.zw)(t.SensingData.Features.AccP2P.X.toFixed(4)),1),(0,l._)("td",null,(0,r.zw)(t.SensingData.Features.AccP2P.Y.toFixed(4)),1),(0,l._)("td",null,(0,r.zw)(t.SensingData.Features.AccP2P.Z.toFixed(4)),1)]),(0,l._)("tr",null,[We,(0,l._)("td",null,(0,r.zw)(t.SensingData.Features.AccRMS.X.toFixed(4)),1),(0,l._)("td",null,(0,r.zw)(t.SensingData.Features.AccRMS.Y.toFixed(4)),1),(0,l._)("td",null,(0,r.zw)(t.SensingData.Features.AccRMS.Z.toFixed(4)),1)]),(0,l._)("tr",null,[Te,(0,l._)("td",null,(0,r.zw)(t.SensingData.Features.VibrationEnergy.X.toFixed(4)),1),(0,l._)("td",null,(0,r.zw)(t.SensingData.Features.VibrationEnergy.Y.toFixed(4)),1),(0,l._)("td",null,(0,r.zw)(t.SensingData.Features.VibrationEnergy.Z.toFixed(4)),1)])])])]),(0,l._)("div",je,[Pe,(0,l.Wm)(K,{ref:e.moduleInfo.ip,style:{height:"250px"},id:e.moduleInfo.ip,xlabelUseTimeFormat:!1,title:"Raw Data-"+e.moduleInfo.ip,yAxisLabel:"G",xAxisLabel:"Index"},null,8,["id","title"])])])])),_:1},8,["id"])])])],64)}}});const Ee=Ae;var ze=Ee;const Re={class:"ssm-manager-opt"},Le=(0,l.Uk)("IP"),He=(0,l.Uk)("Port"),Ue=(0,l.Uk)("新增"),Ne=(0,l.Uk)("PING 工具");function Ve(e,t,a,s,o,n){const i=(0,l.up)("b-input-group-text"),r=(0,l.up)("b-form-input"),d=(0,l.up)("b-button"),c=(0,l.up)("b-input-group"),u=(0,l.up)("b-card"),h=(0,l.up)("PingTool"),m=(0,l.up)("el-drawer");return(0,l.wg)(),(0,l.iD)("div",Re,[(0,l.Wm)(u,null,{default:(0,l.w5)((()=>[(0,l._)("div",null,[(0,l.Wm)(c,null,{prepend:(0,l.w5)((()=>[(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[Le])),_:1}),(0,l.Wm)(r,{style:{width:"100px"},modelValue:o.ip,"onUpdate:modelValue":t[0]||(t[0]=e=>o.ip=e),size:"md"},null,8,["modelValue"]),(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[He])),_:1}),(0,l.Wm)(r,{number:"",modelValue:o.port,"onUpdate:modelValue":t[1]||(t[1]=e=>o.port=e),size:"md"},null,8,["modelValue"])])),append:(0,l.w5)((()=>[(0,l.Wm)(d,{onClick:n.AddBtnHandle},{default:(0,l.w5)((()=>[Ue])),_:1},8,["onClick"]),(0,l.Wm)(d,{variant:"primary",onClick:n.PingBtnHandle},{default:(0,l.w5)((()=>[Ne])),_:1},8,["onClick"])])),_:1})])])),_:1}),(0,l.Wm)(m,{modelValue:o.showPingTool,"onUpdate:modelValue":t[2]||(t[2]=e=>o.showPingTool=e),direction:"btt",title:"Ping Tool",size:"50%"},{default:(0,l.w5)((()=>[(0,l.Wm)(h)])),_:1},8,["modelValue"])])}const Oe=e=>((0,l.dD)("data-v-0fde736c"),e=e(),(0,l.Cn)(),e),Fe={class:"ping-opt d-flex",style:{width:"200px"}},Qe=Oe((()=>(0,l._)("div",null,"IP:",-1))),$e={class:"msg-container"};function Be(e,t,a,s,o,n){const i=(0,l.up)("el-input"),d=(0,l.up)("el-button"),c=(0,l.up)("el-divider");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l._)("div",Fe,[Qe,(0,l._)("div",null,[(0,l.Wm)(i,{modelValue:o.ip,"onUpdate:modelValue":t[0]||(t[0]=e=>o.ip=e)},null,8,["modelValue"])]),(0,l._)("div",null,[(0,l.Wm)(d,{onClick:n.PingBtnHandle,type:o.pinging?"danger":"primary"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(o.pinging?"STOP":"PING"),1)])),_:1},8,["onClick","type"])])]),(0,l.Wm)(c),(0,l._)("div",$e,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o.revMsgList,(e=>((0,l.wg)(),(0,l.iD)("div",{key:e},(0,r.zw)(e),1)))),128))])])}var Ye={data(){return{ip:"192.168.0.1",ws:null,revMsgList:[],pinging:!1}},methods:{PingBtnHandle(){this.pinging?this.PingSTopBtnHandle():(this.revMsgList=[`Ping ${this.ip} (使用32位元組的資料):`],this.ws=new WebSocket(`${f.websocket_host}/ping/${this.ip}`),this.ws.onopen=()=>{console.info("ping ws connected"),this.pinging=!0},this.ws.onmessage=e=>{this.revMsgList.push(e.data),"IP Format Incorrect"==e.data&&(this.pinging=!1,this.ws.close())})},PingSTopBtnHandle(){this.ws.send("stop"),this.ws.close(),this.pinging=!1}}};const Ze=(0,G.Z)(Ye,[["render",Be],["__scopeId","data-v-0fde736c"]]);var qe=Ze,Ge={components:{PingTool:qe},data(){return{ip:"127.0.0.1",port:5e3,showPingTool:!1}},methods:{async AddBtnHandle(){await L(this.ip,this.port),this.$emit("OnModuleAdd",{}),(0,ee.z8)({showClose:!0,type:"success",message:"新增完成"})},async PingBtnHandle(){this.showPingTool=!0}}};const Je=(0,G.Z)(Ge,[["render",Ve]]);var Ke=Je,Xe={data(){return{ModuleList:[]}},components:{ModuleState:ze,ManagerOperatesVue:Ke},computed:{TotalModuleNum(){return this.ModuleList.length}},methods:{async ModuleAddingHandle(e){console.info("??",e),this.ModuleList=await E()},async ModuleRemovedHandle(){this.ModuleList=await E()}},async mounted(){this.ModuleList=await E()}};const et=(0,G.Z)(Xe,[["render",T]]);var tt=et,at={name:"HomeView",components:{ssmManager:tt}};const st=(0,G.Z)(at,[["render",S]]);var ot=st;const nt={class:"py-5 admin-view"},it={class:"row"},lt={class:"col-lg-4"},rt={class:"col-lg-4"},dt={class:"col-lg-4"},ct={class:"row"},ut={class:"col-lg-8"},ht={class:"col-lg-4"};function mt(e,t,a,s,o,n){const i=(0,l.up)("SysSettingCard"),d=(0,l.up)("PCStateCard"),c=(0,l.up)("SSMInfoCard"),u=(0,l.up)("TcpIPClientListCard"),h=(0,l.up)("SystemOperation");return(0,l.wg)(),(0,l.iD)("div",nt,[(0,l._)("p",null,"System Start Time : "+(0,r.zw)(n.AppStartTime),1),(0,l._)("div",it,[(0,l._)("div",lt,[(0,l.Wm)(i)]),(0,l._)("div",rt,[(0,l.Wm)(d,{pcState:o.app_states.pcState},null,8,["pcState"])]),(0,l._)("div",dt,[(0,l.Wm)(c,{ssmNumber:o.app_states.ssmNumber},null,8,["ssmNumber"])])]),(0,l._)("div",ct,[(0,l._)("div",ut,[(0,l.Wm)(u,{tcpClientState:o.app_states.tcpClientState},null,8,["tcpClientState"])]),(0,l._)("div",ht,[(0,l.Wm)(h)])])])}const pt={class:"card system-setting-card",style:{width:"100%"}},wt={class:"card-body"},gt={class:"d-flex"},_t=(0,l._)("h5",{class:"card-title"},"SETTINGS",-1),yt={class:"d-flex justify-content-end w-100"},ft={class:"btn-group !spacing",role:"group","aria-label":"Basic example"},bt=(0,l._)("h6",null,[(0,l._)("b",null,"TCP Connection")],-1),vt=(0,l.Uk)("TCP Server Port"),St=(0,l._)("h6",null,[(0,l._)("b",null,"Devices")],-1);function Dt(e,t,a,o,n,i){const r=(0,l.up)("lock"),d=(0,l.up)("unlock"),c=(0,l.up)("el-icon"),u=(0,l.up)("el-divider"),h=(0,l.up)("el-col"),m=(0,l.up)("el-input"),p=(0,l.up)("el-row"),w=(0,l.Q2)("loading");return(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",pt,[(0,l._)("div",wt,[(0,l._)("div",gt,[_t,(0,l._)("div",yt,[(0,l.wy)((0,l._)("div",ft,[(0,l._)("a",{class:"btn btn-light btn-sm",onClick:t[0]||(t[0]=(...e)=>i.ApplySettingHandle&&i.ApplySettingHandle(...e)),role:"button"},"Apply"),(0,l._)("a",{class:"btn btn-danger btn-sm",onClick:t[1]||(t[1]=(...e)=>i.CancelSettingHandle&&i.CancelSettingHandle(...e)),role:"button"},"Cancel")],512),[[s.F8,!n.settingLock]]),(0,l.Wm)(c,{class:"my-2 mx-2",onClick:t[2]||(t[2]=e=>n.settingLock=!n.settingLock)},{default:(0,l.w5)((()=>[n.settingLock?((0,l.wg)(),(0,l.j4)(r,{key:0})):((0,l.wg)(),(0,l.j4)(d,{key:1}))])),_:1})])]),(0,l.Wm)(u),bt,(0,l.Wm)(p,{gutter:10},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{span:9},{default:(0,l.w5)((()=>[vt])),_:1}),(0,l.Wm)(h,{span:4,class:"input-item-col"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{disabled:n.settingLock,type:"number",modelValue:n.settings.servers.tcpServerPort,"onUpdate:modelValue":t[3]||(t[3]=e=>n.settings.servers.tcpServerPort=e),min:0,style:{width:"120px"}},null,8,["disabled","modelValue"])])),_:1})])),_:1}),(0,l.Wm)(u),St])])),[[w,n.loading]])}var kt={data(){return{loading:!0,settingLock:!0,settings:{tcpClient:{autoKickOutClient:!0,connectionLimits:10},servers:{tcpServerPort:0}}}},methods:{async FetchSettingFromBackend(){this.loading=!0,this.settings=await M(),this.loading=!1},async ApplySettingToBackend(){this.settings=await A(this.settings)},CancelSettingHandle(){this.FetchSettingFromBackend(),this.settingLock=!0},async ApplySettingHandle(){await this.ApplySettingToBackend(),this.settingLock=!0}},mounted(){this.FetchSettingFromBackend()}};const Ct=(0,G.Z)(kt,[["render",Dt]]);var xt=Ct;const It={class:"col-lg card",style:{width:"100%"}},Wt={class:"card-body"},Tt=(0,l._)("h5",{class:"card-title"},"TCP/IP SERVER",-1),jt={class:"row w-100 g-1 d-flex justify-content-start"},Pt={class:"col-lg-4 g-1 justify-content-center bg-light"},Mt=(0,l._)("div",{class:"py-3"},[(0,l._)("u",null,[(0,l._)("b",null,"SERVER STATE")])],-1),At={class:"row"},Et=(0,l._)("div",{class:"col-lg-6"},"HOST:",-1),zt={class:"col-lg-6"},Rt={class:"row"},Lt=(0,l._)("div",{class:"col-lg-6"},"STATUS:",-1),Ht={class:"col-lg-6"},Ut={class:"col-lg-8 bg-light"},Nt=(0,l._)("div",{class:"w-100 py-3"},[(0,l._)("u",null,[(0,l._)("b",{class:""},"CLIENTS")])],-1),Vt=(0,l.Uk)("REMOVE"),Ot={class:"bg-dark"};function Ft(e,t,a,s,o,n){const i=(0,l.up)("el-divider"),d=(0,l.up)("el-tag"),c=(0,l.up)("el-table-column"),u=(0,l.up)("el-button"),h=(0,l.up)("el-table");return(0,l.wg)(),(0,l.iD)("div",It,[(0,l._)("div",Wt,[Tt,(0,l.Wm)(i),(0,l._)("div",jt,[(0,l._)("div",Pt,[Mt,(0,l._)("div",null,[(0,l._)("div",At,[Et,(0,l._)("div",zt,(0,r.zw)(a.tcpServerState.host),1)]),(0,l._)("div",Rt,[Lt,(0,l._)("div",Ht,[(0,l.Wm)(d,{effect:"dark",type:"success",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(a.tcpServerState.state),1)])),_:1})])])])]),(0,l._)("div",Ut,[Nt,(0,l.Wm)(h,{"row-key":"endPoint",data:a.tcpClientState,height:"300px","empty-text":"NO  CONNECTED","highlight-current-row":""},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{prop:"endPoint",label:"EndPoint"}),(0,l.Wm)(c,{prop:"connectedTime",label:"Connect Time"}),(0,l.Wm)(c,{prop:"lastRequestTime",label:"Last Request Time"}),(0,l.Wm)(c,{width:"100",fixed:"right"},{default:(0,l.w5)((e=>[(0,l._)("div",null,[(0,l.Wm)(u,{type:"danger",onClick:t=>n.RemoveBtnHandle(e.row.endPoint)},{default:(0,l.w5)((()=>[Vt])),_:2},1032,["onClick"])])])),_:1}),(0,l.Wm)(c,{type:"expand",fixed:"right"},{default:(0,l.w5)((e=>[(0,l._)("div",Ot,[(0,l._)("div",null,"最近一次接收:"+(0,r.zw)(e.row.lastRequestCmd),1),(0,l._)("div",null,"最近一次回覆:"+(0,r.zw)(e.row.lastRequestCmd),1)])])),_:1})])),_:1},8,["data"])])])])])}var Qt={props:{tcpClientState:{type:Array,default(){return[]}},tcpServerState:{type:Object,default(){return{host:"0.0.0.0:00",state:"Listening"}}}},data(){return{checkEx2Selected:["A"],checkEx2Options:[{item:"A",name:"Option A"}]}},methods:{async RemoveBtnHandle(e){await U(e)},req_res_text_format(e="",t=0){return console.info(e,t),e}}};const $t=(0,G.Z)(Qt,[["render",Ft]]);var Bt=$t;const Yt={class:"col-lg card",style:{width:"100%"}},Zt={class:"card-body"},qt=(0,l._)("h5",{class:"card-title"},"PC STATES",-1),Gt={class:"d-flex justify-content-center states-container"},Jt=(0,l._)("div",null,[(0,l._)("u",null,"RAM")],-1),Kt=(0,l._)("div",null,[(0,l._)("u",null,"CPU")],-1);function Xt(e,t,a,s,o,n){const i=(0,l.up)("el-divider"),r=(0,l.up)("el-progress"),d=(0,l.up)("el-col"),c=(0,l.up)("el-row");return(0,l.wg)(),(0,l.iD)("div",Yt,[(0,l._)("div",Zt,[qt,(0,l.Wm)(i),(0,l._)("div",Gt,[(0,l.Wm)(c,{gutter:30},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{span:12},{default:(0,l.w5)((()=>[Jt,(0,l.Wm)(r,{type:"circle",percentage:a.pcState.ram,color:a.pcState.ram>75?"red":a.pcState.ram>50?"orange":"rgb(32, 160, 255)"},null,8,["percentage","color"])])),_:1}),(0,l.Wm)(d,{span:12},{default:(0,l.w5)((()=>[Kt,(0,l.Wm)(r,{type:"circle",percentage:a.pcState.cpu,color:a.pcState.cpu>50?"red":"rgb(32, 160, 255)"},null,8,["percentage","color"])])),_:1})])),_:1})])])])}var ea={props:{pcState:{type:Object,default(){return{ram:23,cpu:20.2}}}}};const ta=(0,G.Z)(ea,[["render",Xt]]);var aa=ta;const sa={class:"col-lg card",style:{width:"100%"}},oa={class:"card-body"},na=(0,l._)("h5",{class:"card-title"},"SSM STATES",-1),ia={class:"justify-content-center states-container"},la=(0,l._)("div",null,"CONNECTED NUMBER",-1),ra={id:"ssm-number"},da={href:"/"};function ca(e,t,a,s,o,n){const i=(0,l.up)("el-divider"),r=(0,l.up)("count-to");return(0,l.wg)(),(0,l.iD)("div",sa,[(0,l._)("div",oa,[na,(0,l.Wm)(i),(0,l._)("div",ia,[la,(0,l._)("div",ra,[(0,l._)("a",da,[(0,l.Wm)(r,{startVal:0,endVal:a.ssmNumber,duration:1100},null,8,["endVal"])])])])])])}var ua={props:{ssmNumber:{type:Number,default:0}}};const ha=(0,G.Z)(ua,[["render",ca]]);var ma=ha;const pa=e=>((0,l.dD)("data-v-178e9af4"),e=e(),(0,l.Cn)(),e),wa={class:"card",style:{width:"100%"}},ga={class:"card-body"},_a=pa((()=>(0,l._)("h5",{class:"card-title"},"SYSTEM OPERATION",-1))),ya={class:"btn"},fa=(0,l.Uk)("Restart"),ba={class:"btn"},va=(0,l.Uk)("Shut Down");function Sa(e,t,a,s,o,n){const i=(0,l.up)("el-divider"),r=(0,l.up)("b-button");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l._)("div",wa,[(0,l._)("div",ga,[_a,(0,l.Wm)(i),(0,l._)("div",null,[(0,l._)("div",ya,[(0,l.Wm)(r,{"aria-disabled":"",class:"disabled w-100 my-1 bg-primary"},{default:(0,l.w5)((()=>[fa])),_:1})]),(0,l._)("div",ba,[(0,l.Wm)(r,{class:"disabled w-100 my-1 bg-danger"},{default:(0,l.w5)((()=>[va])),_:1})])])])])])}var Da={components:{},data(){return{}}};const ka=(0,G.Z)(Da,[["render",Sa],["__scopeId","data-v-178e9af4"]]);var Ca=ka,xa={components:{SysSettingCard:xt,TcpIPClientListCard:Bt,SSMInfoCard:ma,PCStateCard:aa,SystemOperation:Ca},data(){return{app_states:{},ws:null}},computed:{AppStartTime(){return V()(this.app_states.startupTime).format("yyyy/MM/DD HH:mm:ss")}},methods:{async FetchAppState(){this.app_states=await z()},async WebsocketConnect(){this.ws=new WebSocket(`${f.websocket_host}/app_states`),this.ws.onopen=()=>{console.info("ws opend..")},this.ws.onclose=()=>{console.info("ws closed..")},this.ws.onmessage=e=>this.HandleWSMessage(e)},HandleWSMessage(e=WebSocket){this.app_states=JSON.parse(e.data)}},mounted(){this.FetchAppState(),this.WebsocketConnect()},unmounted(){console.info("des"),this.ws.close()}};const Ia=(0,G.Z)(xa,[["render",mt]]);var Wa=Ia;const Ta={style:{"padding-top":"75px"}},ja={class:"d-flex px-2 py-2"},Pa=(0,l.Uk)("??");function Ma(e,t,a,o,n,i){const r=(0,l.up)("el-radio-button"),d=(0,l.up)("el-radio-group"),c=(0,l.up)("el-divider"),u=(0,l.up)("DignoseDataListView"),h=(0,l.up)("DignoseDataChartView");return(0,l.wg)(),(0,l.iD)("div",Ta,[(0,l._)("div",ja,[(0,l.Wm)(d,{modelValue:n.display_mode,"onUpdate:modelValue":t[0]||(t[0]=e=>n.display_mode=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"LIST"}),(0,l.Wm)(r,{label:"CHART"})])),_:1},8,["modelValue"])]),(0,l.Wm)(c),(0,l.wy)((0,l.Wm)(u,null,null,512),[[s.F8,"LIST"==n.display_mode]]),(0,l.wy)((0,l.Wm)(h,{pause:"CHART"!=n.display_mode},{default:(0,l.w5)((()=>[Pa])),_:1},8,["pause"]),[[s.F8,"CHART"==n.display_mode]])])}const Aa={class:"dignose-list-view px-2"},Ea={class:"d-flex justify-content-end"},za={class:"py-1"},Ra={class:"dignose-detail-info d-flex"},La={class:"d-flex"},Ha=(0,l._)("div",{class:"item-name"},"當前模型",-1),Ua={class:"d-flex"},Na=(0,l._)("div",{class:"item-name"},"Warning Threshold",-1),Va={class:"d-flex"},Oa=(0,l._)("div",{class:"item-name"},"Alarm Threshold",-1),Fa={class:"mx-3","d-flex":""},Qa=(0,l.Uk)("模型列表"),$a=(0,l.Uk)("事件列表"),Ba=(0,l.Uk)("Raw Data"),Ya=(0,l.Uk)("REAL-TIME CHART "),Za={class:"row"},qa={class:"col-lg-1"},Ga={class:"d-flex type-button-container"},Ja={class:"col-lg-11","element-loading-background":"rgba(122, 122, 122, 0.8)"};function Ka(e,t,a,o,n,i){const d=(0,l.up)("el-button"),c=(0,l.up)("CaretRight"),u=(0,l.up)("el-icon"),h=(0,l.up)("el-table-column"),m=(0,l.up)("el-tag"),p=(0,l.up)("el-input-number"),w=(0,l.up)("el-table"),g=(0,l.up)("ArrowDownBold"),_=(0,l.up)("ArrowUpBold"),y=(0,l.up)("b-button"),f=(0,l.up)("GPMChartVue"),b=(0,l.up)("ModelListView"),v=(0,l.Q2)("loading");return(0,l.wg)(),(0,l.iD)("div",Aa,[(0,l._)("div",Ea,[(0,l.Wm)(d,{onClick:i.TableExpandHandle},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(this.expandAll?"全部收合":"全部展開"),1)])),_:1},8,["onClick"])]),(0,l.wy)(((0,l.wg)(),(0,l.j4)(w,{"default-sort":{prop:"EqName",order:"ascending"},height:i.table_height,data:n.DignoseDatas,"highlight-current-row":"",onRowClick:i.TableRowClickHandle,onExpandChange:i.ExpandHandle,"row-class-name":i.tableRowClassName,"row-key":"IP",ref:"table"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{fixed:"'left'",width:"40"},{default:(0,l.w5)((e=>[(0,l._)("div",za,[(0,l.wy)((0,l.Wm)(u,{size:20,color:"rgb(64, 158, 255)"},{default:(0,l.w5)((()=>[(0,l.Wm)(c)])),_:2},1536),[[s.F8,e.row.IP==n.selectedDiagnoseData.IP]])])])),_:1}),(0,l.Wm)(h,{sortable:"",fixed:"left",prop:"IP",label:"IP",width:"140"}),(0,l.Wm)(h,{sortable:"",prop:"EqName",label:"EQ Name"}),(0,l.Wm)(h,{sortable:"",prop:"UnitName",label:"Unit Name"}),(0,l.Wm)(h,{sortable:"",prop:"HealthScore",label:"Health Score"}),(0,l.Wm)(h,{sortable:"",prop:"AlertIndex",label:"Alert Index"}),(0,l.Wm)(h,{sortable:"",label:"模組狀態"},{default:(0,l.w5)((e=>[(0,l.Wm)(m,{effect:"dark",size:"large",style:{width:"100px"},type:e.row.ModuleAbnormal?"danger":"success"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.row.ModuleAbnormal?"異常":"正常"),1)])),_:2},1032,["type"])])),_:1}),(0,l.Wm)(h,{type:"expand"},{default:(0,l.w5)((e=>[(0,l._)("div",Ra,[(0,l._)("div",null,[(0,l._)("div",La,[Ha,(0,l._)("div",null,(0,r.zw)(e.row.DignoseDetailData.currentModelName),1)]),(0,l._)("div",Ua,[Na,(0,l._)("div",null,[(0,l.Wm)(p,{max:100,min:0,step:.1,size:"small",modelValue:i.GetTreshodlVal(e.row).warningThreshold,"onUpdate:modelValue":t=>i.GetTreshodlVal(e.row).warningThreshold=t,onChange:t=>i.SetWarningThreshold(e.row.IP)},null,8,["step","modelValue","onUpdate:modelValue","onChange"])])]),(0,l._)("div",Va,[Oa,(0,l._)("div",null,[(0,l.Wm)(p,{max:100,min:0,step:.1,size:"small",modelValue:i.GetTreshodlVal(e.row).alarmThreshold,"onUpdate:modelValue":t=>i.GetTreshodlVal(e.row).alarmThreshold=t,onChange:t=>i.SetAlarmThreshold(e.row.IP)},null,8,["step","modelValue","onUpdate:modelValue","onChange"])])])]),(0,l._)("div",Fa,[(0,l.Wm)(d,{onClick:t=>i.ShowModelList(e.row.IP)},{default:(0,l.w5)((()=>[Qa])),_:2},1032,["onClick"]),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[$a])),_:1}),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[Ba])),_:1})])])])),_:1})])),_:1},8,["height","data","onRowClick","onExpandChange","row-class-name"])),[[v,n.loading]]),(0,l._)("div",{class:(0,r.C_)(["d-flex",["showing-down-arrow","fixed-in-bottom"]])},[(0,l.Wm)(y,{class:"btn-share-chart-show",variant:n.share_chart_show?"light":"primary",onClick:t[0]||(t[0]=e=>n.share_chart_show=!n.share_chart_show)},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{class:"mx-2"},{default:(0,l.w5)((()=>[n.share_chart_show?((0,l.wg)(),(0,l.j4)(g,{key:0})):((0,l.wg)(),(0,l.j4)(_,{key:1}))])),_:1}),Ya])),_:1},8,["variant"])]),(0,l.Wm)(s.uT,{name:"el-zoom-in-bottom"},{default:(0,l.w5)((()=>[(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",{class:"share-chart-container fixed-in-bottom",style:(0,r.j5)(n.current_share_chart_style)},[(0,l._)("div",Za,[(0,l._)("div",qa,[(0,l._)("div",Ga,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.display_modes,(e=>((0,l.wg)(),(0,l.iD)("div",{class:"py-1 bt-container",key:e.value},[(0,l.Wm)(y,{size:"sm",class:"w-100",onClick:t=>n.chart_display_mode=e.value,variant:n.chart_display_mode==e.value?"primary":"light"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.label),1)])),_:2},1032,["onClick","variant"])])))),128))])]),(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",Ja,[((0,l.wg)(),(0,l.j4)(f,{class:"share-chart",chart_id:"share-chart",key:n.selectedDiagnoseData.IP+n.chart_display_mode,title:i.ChartTitle,yAxisLabel:i.ylabel,ref:"trendChart"},null,8,["title","yAxisLabel"]))])),[[v,n.chart_loading]])])],4)),[[s.F8,n.share_chart_show],[v,n.loading]])])),_:1}),(0,l.Wm)(b,{ref:"modelListView"},null,512)])}a(1703);function Xa(e={chartDatas:{}},t,a=[{name:"",value:"",color:""}]){if(!es.find((e=>e.value==t)))throw new Error('display_mode must be "HS"、"AID" or "AIH"');var s,o="gold";if("HS"==t&&(s=e.chartDatas.healthScoreList,o="rgb(21, 237, 201)"),"AID"==t&&(s=e.chartDatas.alertIndex_by_Day_List),"AIH"==t&&(s=e.chartDatas.alertIndex_by_Hour_List),void 0==s)return{timeLs:[],datasets:[]};if(0==s.length)return{timeLs:[],datasets:[]};var n=s.timeList,i=s.valueList,l=[{label:t.toString(),data:i,borderColor:o}];return void 0!=a&&a.forEach((e=>{var t=[];for(let a=0;a<i.length;a++)t.push(e.value);l.push({label:e.name,data:t,borderColor:e.color})})),{timeLs:n,datasets:l}}const es=[{label:"Health Score",value:"HS"},{label:"Alert Index(day)",value:"AID"},{label:"Alert Index(Hour)",value:"AIH"}],ts={class:"d-flex"},as={class:"d-flex justify-content-start"},ss=(0,l.Uk)("重新整理"),os={class:"d-flex justify-content-flex-end ip-select"},ns=(0,l.Uk)("刪除");function is(e,t,a,s,o,n){const i=(0,l.up)("el-button"),d=(0,l.up)("el-option"),c=(0,l.up)("el-select"),u=(0,l.up)("el-table-column"),h=(0,l.up)("el-tag"),m=(0,l.up)("el-table"),p=(0,l.up)("el-drawer"),w=(0,l.Q2)("loading");return(0,l.wg)(),(0,l.j4)(p,{modelValue:o.show,"onUpdate:modelValue":t[3]||(t[3]=e=>o.show=e),direction:"rtl",size:"70%",title:`模型列表 : ${o.EQ}/${o.UNIT}(${o.IP})`},{default:(0,l.w5)((()=>[(0,l._)("div",ts,[(0,l._)("div",as,[(0,l.Wm)(i,{dark:"",onClick:t[0]||(t[0]=e=>n.Fetch())},{default:(0,l.w5)((()=>[ss])),_:1})]),(0,l._)("div",os,[(0,l.Wm)(c,{modelValue:o.IP,"onUpdate:modelValue":t[1]||(t[1]=e=>o.IP=e),onChange:t[2]||(t[2]=e=>n.Fetch())},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o.module_infos,(e=>((0,l.wg)(),(0,l.j4)(d,{key:e.IP,label:`${e.EQ}/${e.UNIT}(${e.IP})`,value:e.IP},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])]),(0,l.wy)(((0,l.wg)(),(0,l.j4)(m,{data:o.modelData},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{prop:"Recipe_ID",label:"模型名稱",fixed:"left",width:"160px"}),(0,l.Wm)(u,{prop:"Model_Start_Time",label:"開始時間"}),(0,l.Wm)(u,{prop:"Model_End_Time",label:"結束時間"}),(0,l.Wm)(u,{prop:"Comment",label:"Comment"}),(0,l.Wm)(u,{prop:"Enabled",label:"狀態"},{default:(0,l.w5)((e=>[(0,l.Wm)(h,{effect:"dark",style:{width:"70px"},type:e.row.Enabled?"success":"danger"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.row.Enabled?"啟用":"停用"),1)])),_:2},1032,["type"])])),_:1}),(0,l.Wm)(u,{label:"操作",fixed:"right",width:"160px"},{default:(0,l.w5)((e=>[(0,l.Wm)(i,{type:e.row.Enabled?"danger":"success",plain:"",onClick:t=>n.ModelEnableHandle(e.row.Recipe_ID,!e.row.Enabled)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.row.Enabled?"停用":"啟用"),1)])),_:2},1032,["type","onClick"]),(0,l.Wm)(i,{type:"danger",plain:"",onClick:t=>n.ModelDeleteHandle(e.row.Recipe_ID)},{default:(0,l.w5)((()=>[ns])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[w,o.loading]])])),_:1},8,["modelValue","title"])}const ls=f.idms_websocket_host;async function rs(){return await new Promise(((e,t)=>{var a=new WebSocket(`${ls}/ModuleInfoGet`);a.onopen=()=>a.send("GetInfos"),a.onmessage=t=>{a.close(),e(JSON.parse(t.data))},a.onerror=e=>t(e)}))}async function ds(){return await new Promise(((e,t)=>{var a=new WebSocket(`${ls}/Dignose?type=list`);a.onopen=()=>e(a),a.onerror=e=>t(e)}))}async function cs(e){return await new Promise(((t,a)=>{var s=new WebSocket(`${ls}/Dignose?type=chart&number=90&ip=${e}`);s.onopen=()=>t(s),s.onerror=()=>a(null)}))}async function us(e="ip"){return await new Promise(((t,a)=>{var s=new WebSocket(`${ls}/Diagnose/ModelInfo?StatesMonitor=FALSE`);s.onopen=()=>{s.send(`GIVEMEINFO,${e}`)},s.onmessage=e=>{const a=JSON.parse(e.data);var o=a.EQ,n=a.UNIT,i=a.modelData;s.close(),t({EQ:o,UNIT:n,modelData:i})},s.onerror=e=>{a(e)}}))}async function hs(e){return await new Promise(((t,a)=>{var s=new WebSocket(`${f.idms_websocket_host}/Settings?Get=DignoseThresholds&IP=${e}`);s.onmessage=e=>{var a=JSON.parse(e.data);s.close(),t(a)},s.onerror=e=>a(e)}))}async function ms(e,t){return await new Promise(((a,s)=>{var o=new WebSocket(`${ls}/Settings?IP=${e}&DignoseWarningThres=${t}`);o.onmessage=e=>{o.close(),a(JSON.parse(e.data))},o.onerror=e=>s(e)}))}async function ps(e,t){return await new Promise(((a,s)=>{var o=new WebSocket(`${ls}/Settings?IP=${e}&DignoseAlarmThres=${t}`);o.onmessage=e=>{o.close(),a(JSON.parse(e.data))},o.onerror=e=>s(e)}))}async function ws(e,t,a){return await new Promise(((s,o)=>{var n=new WebSocket(`${ls}/Diagnose/ModelInfo`);n.onopen=()=>{n.send(JSON.stringify({Action:a?"Enable":"Disable",IP:e,Model_Name:t}))},n.onmessage=e=>{n.close(),s(JSON.parse(e.data))},n.onerror=e=>o(e)}))}async function gs(e,t){return await new Promise(((a,s)=>{var o=new WebSocket(`${ls}/Diagnose/ModelInfo`);o.onopen=()=>{o.send(JSON.stringify({Action:"Delete",IP:e,Model_Name:t}))},o.onmessage=e=>{o.close(),a(JSON.parse(e.data))},o.onerror=e=>s(e)}))}var _s={data(){return{show:!1,IP:"",EQ:"",UNIT:"",modelData:[],loading:!1,module_infos:[]}},methods:{ShowModelList(e){this.show=!0,this.IP=e,this.Fetch()},async UpdateModuleInfos(){this.module_infos=await rs()},async Fetch(){this.loading=!0;var e=await us(this.IP);console.info("Fetch Models",e),this.EQ=e.EQ,this.UNIT=e.UNIT,this.modelData=e.modelData,this.loading=!1},async ModelDeleteHandle(e=""){var t=await gs(this.IP,e);t.success&&this.Fetch()},async ModelEnableHandle(e="",t=!1){var a=await ws(this.IP,e,t);a.success&&this.Fetch()}},mounted(){this.UpdateModuleInfos()}};const ys=(0,G.Z)(_s,[["render",is]]);var fs=ys;class bs{constructor(){(0,O.Z)(this,"warningThreshold",69),(0,O.Z)(this,"alarmThreshold",87)}}var vs={components:{GPMChartVue:K,ModelListView:fs},data(){return{ws:{type:WebSocket},share_chart_show:!1,trendchart_ws:null,loading:!0,chart_loading:!1,expandAll:!1,display_modes:es,DignoseDatas:[],chart_display_mode:"HS",selectedDiagnoseData:{IP:"???"},renderingDiagnoseData:[],ThresholdSettings:{ip:new bs},current_share_chart_style:{backgroundColor:"#313131",border:"1px solid black"},share_chart_styles:{normal:{backgroundColor:"#313131",border:"1px solid black"},warning:{backgroundColor:"#e5bc41",border:"1px solid white"},danger:{backgroundColor:"rgb(217, 94, 94)",border:"1px solid white"}}}},methods:{TableExpandHandle(){this.expandAll=!this.expandAll,this.DignoseDatas.forEach((e=>{this.$refs.table.toggleRowExpansion(e,this.expandAll)}))},tableRowClassName({row:e}){return e.DignoseDetailData.dignoseResult},async TableRowClickHandle(e){this.selectedDiagnoseData.IP!=e.IP&&(this.chart_loading=!0,console.info("to create ws",e.IP),this.RTChartWebsocketIni(e.IP)),this.selectedDiagnoseData=e;var t=await hs(this.selectedDiagnoseData.IP);t.success&&(this.ThresholdSettings[this.selectedDiagnoseData.IP]=t.data)},async RTChartWebsocketIni(e){this.trendchart_ws&&this.trendchart_ws.close(),this.trendchart_ws=await cs(e),this.chart_loading=null==this.trendchart_ws,null!=this.trendchart_ws?this.trendchart_ws.onmessage=e=>{var t=JSON.parse(e.data);this.RenderTrendChart(t[0])}:await this.RTChartWebsocketIni(e)},RenderTrendChart(e){try{this.renderingDiagnoseData=e;var t=void 0;if("HS"===this.chart_display_mode){var a=e.DignoseDetailData.WarningThreshold,s=e.DignoseDetailData.AlarmThreshold;t=[{name:"Warning",value:a,color:"gold"},{name:"alarm",value:s,color:"red"}]}var o=Xa(e,this.chart_display_mode,t);if(this.$refs.trendChart)var n=this.$refs.trendChart.UpdateChart(o.timeLs,o.datasets);"err"==n&&this.RTChartWebsocketIni(this.selectedDiagnoseData.IP);var i=e.DignoseDetailData.dignoseResult;this.current_share_chart_style=this.share_chart_styles[i]}catch(l){console.info(l)}},GetTreshodlVal(e){return void 0==this.ThresholdSettings[e.IP]?new bs:this.ThresholdSettings[e.IP]},async ExpandHandle(e,t=[]){if(0!=t.length){var a=e.IP,s=await hs(a);s.success&&(this.ThresholdSettings[a]=s.data)}},async SetWarningThreshold(e){await ms(e,this.ThresholdSettings[e].warningThreshold)},async SetAlarmThreshold(e){await ps(e,this.ThresholdSettings[e].alarmThreshold)},ShowModelList(e){this.$refs.modelListView.UpdateModuleInfos(),this.$refs.modelListView.ShowModelList(e)}},computed:{ChartTitle(){return this.selectedDiagnoseData.EqName?`${this.DisplayModeName}: ${this.selectedDiagnoseData.EqName}-${this.selectedDiagnoseData.UnitName} (${this.selectedDiagnoseData.IP})`:"點選表格以顯示趨勢圖表"},DisplayModeName(){return"HS"==this.chart_display_mode?"健康分數趨勢":"AID"==this.chart_display_mode?"劣化指標(小時)":"AIH"==this.chart_display_mode?"劣化指標(天)":""},ylabel(){return"HS"==this.chart_display_mode?"Score":"AID"==this.chart_display_mode|"AIH"==this.chart_display_mode?"Index":""},table_height(){return console.info(window.innerHeight),this.share_chart_show?.35*window.innerHeight:window.innerHeight-220}},async mounted(){this.ws=await ds(),console.info("s",this.ws),this.ws.onmessage=e=>{this.loading=!1,this.DignoseDatas=JSON.parse(e.data)}},unmounted(){this.ws.close()}};const Ss=(0,G.Z)(vs,[["render",Ka]]);var Ds=Ss;const ks=e=>((0,l.dD)("data-v-68871a16"),e=e(),(0,l.Cn)(),e),Cs={id:"dignose-chart-view"},xs={class:"charting-options py-1 px-1 mx-2 d-flex"},Is={class:"d-flex justify-content-start w-100"},Ws={class:"d-flex justify-content-end w-70"},Ts=ks((()=>(0,l._)("div",{class:"py-2",style:{width:"300px","font-size":"16px"}},"Column Number",-1))),js={class:"row g-0"},Ps={key:0,class:"empty-result"},Ms=["id","onClick"],As={class:"value-show"};function Es(e,t,a,s,o,n){const i=(0,l.up)("el-backtop"),d=(0,l.up)("el-radio-button"),c=(0,l.up)("el-radio-group"),u=(0,l.up)("el-option"),h=(0,l.up)("el-select"),m=(0,l.up)("Search"),p=(0,l.up)("el-icon"),w=(0,l.up)("el-input"),g=((0,l.up)("Lock"),(0,l.up)("Unlock"),(0,l.up)("el-input-number"),(0,l.up)("el-empty")),_=(0,l.up)("ZoomIn"),y=(0,l.up)("GPMChart"),f=(0,l.up)("el-drawer"),b=(0,l.Q2)("loading");return(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",Cs,[(0,l.Wm)(i,{right:30,bottom:50}),(0,l._)("div",xs,[(0,l._)("div",Is,[(0,l.Wm)(c,{modelValue:o.display_mode,"onUpdate:modelValue":t[0]||(t[0]=e=>o.display_mode=e),onChange:n.RenderCharts},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o.display_modes,(e=>((0,l.wg)(),(0,l.j4)(d,{key:e.value,label:e.label},null,8,["label"])))),128))])),_:1},8,["modelValue","onChange"])]),(0,l._)("div",Ws,[Ts,(0,l.Wm)(h,{size:"large",modelValue:o.ColsNumber,"onUpdate:modelValue":t[1]||(t[1]=e=>o.ColsNumber=e),onChange:n.RenderCharts},{default:(0,l.w5)((()=>[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)([1,2,3],(e=>(0,l.Wm)(u,{key:e,value:e,label:e},null,8,["value","label"]))),64))])),_:1},8,["modelValue","onChange"]),(0,l.Wm)(w,{modelValue:o.search_str,"onUpdate:modelValue":t[2]||(t[2]=e=>o.search_str=e),placeholder:"輸入內容查詢...",clearable:""},{prepend:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l.Wm)(m)])),_:1})])),_:1},8,["modelValue"])]),(0,l.kq)("",!0)]),(0,l._)("div",js,[0==n.DignoseDatas_Show.length?((0,l.wg)(),(0,l.iD)("div",Ps,[(0,l.Wm)(g,{description:"未包含任何圖表項目","image-size":200})])):((0,l.wg)(!0),(0,l.iD)(l.HY,{key:1},(0,l.Ko)(n.DignoseDatas_Show,(e=>((0,l.wg)(),(0,l.iD)("div",{class:(0,r.C_)([`col-md-${n.colsNumReuslt}`,"charting-region"]),key:e.IP},[(0,l._)("span",{class:"zoom-icon",id:e.IP,onClick:t=>n.ZoomClickHandle(e.IP)},[(0,l.Wm)(p,{size:20},{default:(0,l.w5)((()=>[(0,l.Wm)(_)])),_:1})],8,Ms),(0,l._)("span",As,(0,r.zw)(e.HealthScore),1),((0,l.wg)(),(0,l.j4)(y,{onClick:t=>n.ZoomClickHandle(e.IP),ref_for:!0,ref:"health-chart-"+e.IP,class:"chart-h",chart_id:e.IP+"-HealthScore",title:`${e.EqName}-${e.UnitName}(${e.IP})`,yAxisLabel:n.ylabel,key:n.ylabel+o.ColsNumber},null,8,["onClick","chart_id","title","yAxisLabel"]))],2)))),128))]),(0,l.Wm)(f,{modelValue:o.zooming,"onUpdate:modelValue":t[6]||(t[6]=e=>o.zooming=e),direction:"btt",size:"90%"},{default:(0,l.w5)((()=>[((0,l.wg)(),(0,l.j4)(y,{ref:"zoom-chart",onClick:t[5]||(t[5]=e=>o.zooming=!1),class:"chart-zoom",chart_id:"zoom-chart",title:`${o.zoom_data.EqName}-${o.zoom_data.UnitName}(${o.zoom_data.IP})`,yAxisLabel:n.ylabel,key:o.zoom_data.IP},null,8,["title","yAxisLabel"]))])),_:1},8,["modelValue"])])),[[b,o.loading]])}a(6699);var zs={props:{pause:{type:Boolean,default:!0}},data(){return{ws:null,loading:!0,DignoseDatas:[],zoom_data:{EqName:"",UnitName:"",IP:""},MaxHSDisplayNum:50,settinglock:!0,display_mode:"Health Score",display_modes:es,search_str:"",ColsNumber:2,zooming:!1,zoomingIP:""}},computed:{DignoseDatas_Show(){if(""==this.search_str)return this.DignoseDatas;var e=this.search_str.toUpperCase(),t=[];return this.DignoseDatas.forEach((a=>{a.IP.toUpperCase().includes(e)|a.EqName.toUpperCase().includes(e)|a.UnitName.toUpperCase().includes(e)|(a.EqName+"-"+a.UnitName).toUpperCase().includes(e)&&t.push(a)})),t},ylabel(){return"Health Score"==this.display_mode?"Score":"Alert Index(day)"==this.display_mode|"Alert Index(Hour)"==this.display_mode?"Index":""},colsNumReuslt(){return 12/this.ColsNumber},selected_display_mode_value(){return this.display_modes.find((e=>e.label==this.display_mode)).value}},methods:{ZoomClickHandle(e){this.zooming=!0,this.zoom_data=this.DignoseDatas.find((t=>t.IP==e));var t=Xa(this.zoom_data,this.selected_display_mode_value),a=t.timeLs,s=t.datasets;setTimeout((()=>{this.$refs["zoom-chart"].UpdateChart(a,s)}),200),this.zoomingIP=e},async RenderCharts(){this.pause||this.DignoseDatas.forEach((e=>{var t=Xa(e,this.selected_display_mode_value),a=t.timeLs,s=t.datasets,o=this.$refs[`health-chart-${e.IP}`];o&&o[0]&&o[0].UpdateChart(a,s),this.zooming&&e.IP==this.zoomingIP&&(this.zoom_data=e,this.$refs["zoom-chart"].UpdateChart(a,s))}))},WsConnect(){this.ws=new WebSocket(`${f.idms_websocket_host}/Dignose?type=chart&number=${this.MaxHSDisplayNum}`),this.ws.onopen=()=>{this.loading=!1},this.ws.onmessage=e=>{this.loading=!1,this.DignoseDatas=JSON.parse(e.data),this.RenderCharts()},this.ws.onclose=()=>{console.info("ws close"),this.loading=!0,this.ws.onmessage=null,this.WsConnect()}},HSDisplayNumChangedHandel(){console.info(this.MaxHSDisplayNum),this.ws.onmessage=null,this.ws.close(),this.WsConnect()}},components:{GPMChart:K},mounted(){this.WsConnect()},unmounted(){this.ws.close()}};const Rs=(0,G.Z)(zs,[["render",Es],["__scopeId","data-v-68871a16"]]);var Ls=Rs,Hs={data(){return{display_mode:"LIST"}},components:{DignoseDataListView:Ds,DignoseDataChartView:Ls}};const Us=(0,G.Z)(Hs,[["render",Ma]]);var Ns=Us;const Vs={style:{"padding-top":"75px"}},Os=["href"];function Fs(e,t,a,o,n,i){const d=(0,l.up)("WarningFilled"),c=(0,l.up)("el-icon"),u=(0,l.up)("el-table-column"),h=(0,l.up)("el-tag"),m=(0,l.up)("el-table");return(0,l.wg)(),(0,l.iD)("div",Vs,[(0,l.Wm)(m,{stripe:"",data:n.ModuleStatesData,"row-key":"IP"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{width:"44",fixed:"left"},{default:(0,l.w5)((e=>[(0,l.wy)((0,l.Wm)(c,{color:"gold",size:30},{default:(0,l.w5)((()=>[(0,l.Wm)(d)])),_:2},1536),[[s.F8,(!e.row.ControllerAbnormal&&e.row.SensorAbnormal)|(e.row.ControllerAbnormal&&!e.row.SensorAbnormal)]]),(0,l.wy)((0,l.Wm)(c,{color:"red",size:30},{default:(0,l.w5)((()=>[(0,l.Wm)(d)])),_:2},1536),[[s.F8,e.row.ControllerAbnormal&&e.row.SensorAbnormal]])])),_:1}),(0,l.Wm)(u,{prop:"IP",label:"IP",sortable:"",fixed:"left"},{default:(0,l.w5)((e=>[(0,l._)("a",{href:"http://"+e.row.IP,target:"popup"},(0,r.zw)(e.row.IP),9,Os)])),_:1}),(0,l.Wm)(u,{prop:"EqName",label:"EQ Name",sortable:""}),(0,l.Wm)(u,{prop:"UnitName",label:"UNIT Name",sortable:""}),(0,l.Wm)(u,{prop:"ControllerAbnormal",label:"控制器狀態"},{default:(0,l.w5)((e=>[(0,l.Wm)(h,{style:{width:"100px"},type:e.row.ControllerAbnormal?"danger":"success","disable-transitions":"",effect:"dark"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.row.ControllerAbnormal?"異常":"正常"),1)])),_:2},1032,["type"])])),_:1}),(0,l.Wm)(u,{prop:"SensorAbnormal",label:"感測器狀態"},{default:(0,l.w5)((e=>[(0,l.Wm)(h,{style:{width:"100px"},type:e.row.SensorAbnormal?"danger":"success","disable-transitions":"",effect:"dark"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.row.SensorAbnormal?"異常":"正常"),1)])),_:2},1032,["type"])])),_:1})])),_:1},8,["data"])])}var Qs={data(){return{ModuleStatesData:[],ws:null}},mounted(){this.WebSocketInitial()},methods:{WebSocketInitial(){this.ws=new WebSocket(`${f.idms_websocket_host}/ModuleStates`),this.ws.onmessage=e=>{this.ModuleStatesData=JSON.parse(e.data)},this.ws.onclose=()=>{this.WebSocketInitial()}}}};const $s=(0,G.Z)(Qs,[["render",Fs]]);var Bs=$s;const Ys={class:"h-100",style:{"padding-top":"80px"}},Zs={class:"d-flex flex-column",style:{height:"100%"}},qs={class:"d-flex flex-row row settings"},Gs={class:"col-lg-2 d-flex py-1"},Js=(0,l._)("b",null,"EQ",-1),Ks={class:"col-lg-2 d-flex"},Xs=(0,l._)("b",null,"UNIT",-1),eo={class:"d-flex"},to=["textContent"],ao={class:"w-100",style:{"text-align":"right"}},so={class:"col-lg-2 d-flex"},oo=(0,l._)("b",null,"查詢項目",-1),no={class:"col-lg-2 d-flex"},io=(0,l._)("b",null,"開始時間",-1),lo={class:"col-lg-2 d-flex"},ro=(0,l._)("b",null,"結束時間",-1),co={class:"col-lg-2 flex-fill"},uo=(0,l.Uk)("查詢"),ho={class:"result d-flex flex-column flex-fill w-100 my-1"},mo={class:"d-flex result-message font-red"},po={class:"d-flex flex-row shadow-sm px-2",style:{height:"25px"}},wo={class:"flex-fill text-left",style:{"font-size":"9px"}},go={style:{"font-size":"16px"}};function _o(e,t,a,s,o,n){const i=(0,l.up)("el-option"),d=(0,l.up)("el-select"),c=(0,l.up)("el-date-picker"),u=(0,l.up)("b-button"),h=(0,l.up)("GPMPreviewChart"),m=(0,l.up)("GPMChart"),p=(0,l.up)("setting"),w=(0,l.up)("el-icon"),g=(0,l.up)("DatabaseSetting"),_=(0,l.up)("el-drawer"),y=(0,l.Q2)("loading");return(0,l.wg)(),(0,l.iD)("div",Ys,[(0,l._)("div",Zs,[(0,l._)("div",qs,[(0,l._)("div",Gs,[Js,(0,l.Wm)(d,{class:"w-100",modelValue:o.QueryOptions.SelectedEQ,"onUpdate:modelValue":t[0]||(t[0]=e=>o.QueryOptions.SelectedEQ=e),onChange:t[1]||(t[1]=e=>o.QueryOptions.SelectedUNIT="")},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.EQList,(e=>((0,l.wg)(),(0,l.j4)(i,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,l._)("div",Ks,[Xs,(0,l.Wm)(d,{class:"w-100",modelValue:o.QueryOptions.SelectedUNIT,"onUpdate:modelValue":t[2]||(t[2]=e=>o.QueryOptions.SelectedUNIT=e)},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.UNITS_IN_EQ,(e=>((0,l.wg)(),(0,l.j4)(i,{key:e.IP,label:`${e.UNIT}(${e.IP})`,value:e.IP},{default:(0,l.w5)((()=>[(0,l._)("div",eo,[(0,l._)("div",{textContent:(0,r.zw)(e.UNIT),style:{color:"black"}},null,8,to),(0,l._)("div",ao,[(0,l._)("u",null,(0,r.zw)(e.IP),1)])])])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,l._)("div",so,[oo,(0,l.Wm)(d,{class:"w-100",modelValue:o.QueryOptions.SelectedQueryItem,"onUpdate:modelValue":t[3]||(t[3]=e=>o.QueryOptions.SelectedQueryItem=e)},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o.QueryItems,(e=>((0,l.wg)(),(0,l.j4)(i,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,l._)("div",no,[io,(0,l.Wm)(c,{class:"w-100",style:{width:"203px"},modelValue:o.QueryOptions.TimeRange[0],"onUpdate:modelValue":t[4]||(t[4]=e=>o.QueryOptions.TimeRange[0]=e),type:"datetime"},null,8,["modelValue"])]),(0,l._)("div",lo,[ro,(0,l.Wm)(c,{class:"w-100",style:{width:"203px"},modelValue:o.QueryOptions.TimeRange[1],"onUpdate:modelValue":t[5]||(t[5]=e=>o.QueryOptions.TimeRange[1]=e),type:"datetime"},null,8,["modelValue"])]),(0,l._)("div",co,[(0,l.Wm)(u,{class:"w-100 bg-primary",onClick:n.QueryHandle},{default:(0,l.w5)((()=>[uo])),_:1},8,["onClick"])])]),(0,l._)("div",ho,[(0,l._)("div",mo,(0,r.zw)(o.ServerResponseData.message),1),(0,l.Wm)(h,{ref:"preview_chart",title:"Preview",yAxisLabel:n.Ylabel,xAxisLabel:"",onDateTimeIntervalOnchanged:n.GetSliceDataHandle},null,8,["yAxisLabel","onDateTimeIntervalOnchanged"]),(0,l.wy)(((0,l.wg)(),(0,l.j4)(m,{class:"query-chart flex-fill",chart_id:"query-chart",ref:"query_chart",title:`${o.QueryOptions.SelectedQueryItem}:${o.QueryOptions.SelectedEQ}/${o.QueryOptions.SelectedUNIT}`,key:o.chart_key,yAxisLabel:n.Ylabel},null,8,["title","yAxisLabel"])),[[y,o.chart_loading]])]),(0,l._)("div",po,[(0,l._)("div",wo,(0,r.zw)(o.ServerResponseData.QueryID),1),(0,l._)("div",go,[(0,l.Wm)(w,{style:{cursor:"pointer"},onClick:t[6]||(t[6]=e=>o.showSettingPnl=!o.showSettingPnl)},{default:(0,l.w5)((()=>[(0,l.Wm)(p)])),_:1})])])]),(0,l.Wm)(_,{modelValue:o.showSettingPnl,"onUpdate:modelValue":t[7]||(t[7]=e=>o.showSettingPnl=e),title:"SETTING",size:"50%"},{default:(0,l.w5)((()=>[(0,l.Wm)(g)])),_:1},8,["modelValue"])])}const yo={class:"d-flex"},fo={class:"preview-region",id:"preview-region",style:{height:"180px"}},bo={id:"left-bound",class:"bound-opt b-l bg-info h-100"},vo={id:"right-bound",class:"bound-opt b-r bg-info h-100"},So=["id"];function Do(e,t,a,o,n,i){const d=(0,l.up)("el-button"),c=(0,l.Q2)("loading");return(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",{class:"gpm-preview-chart",style:(0,r.j5)(n.chart_style)},[(0,l.wy)((0,l._)("div",null,[(0,l._)("div",yo,[(0,l.Wm)(d,{plain:"",type:n.isAdjustWindowSizeMode?"danger":"info",size:"small",onClick:t[0]||(t[0]=e=>{n.isAdjustWindowSizeMode=!n.isAdjustWindowSizeMode,n.isRightBoundClickDown=!1})},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(n.isAdjustWindowSizeMode?"結束調整":"調整窗大小"),1)])),_:1},8,["type"])]),(0,l._)("div",fo,[(0,l._)("div",{class:"d-flex preview h-100",id:"time-window",style:(0,r.j5)(n.time_window_style)},[(0,l.wy)((0,l._)("div",bo,null,512),[[s.F8,n.isAdjustWindowSizeMode]]),(0,l.wy)((0,l._)("div",vo,null,512),[[s.F8,n.isAdjustWindowSizeMode]])],4),(0,l._)("canvas",{class:"preview",id:"preview_chart_"+a.chart_id},null,8,So)])],512),[[s.F8,n.PreviewShow]])],4)),[[c,n.loading]])}var ko={props:{chart_id:{type:String,default:"preview-chart"},title:{type:String,default:"Title"},xAxisLabel:{type:String,default:"時間"},yAxisLabel:{type:String,default:"YLabel"},xlabelUseTimeFormat:{type:Boolean,default:!0}},data(){return{loading:!1,Rendering:!1,PreviewShow:!0,chart_style:{backgroundColor:"#202020",border:"1px solid grey",margin:"3px",borderRadius:"4px"},preview_chartInstance:{data:{labels:[],datasets:[]},update:()=>{}},options:{responsive:!0,maintainAspectRatio:!1,lineTension:0,tooltips:{mode:"index",intersect:!0},layout:{padding:{top:1}},title:{display:!0,text:this.title,fontSize:14,fontColor:"white"},scales:{yAxes:[{gridLines:{color:"#313131"},ticks:{beginAtZero:!0,padding:20,fontColor:"white",autoskip:!0,maxTicksLimit:10,min:0,max:100},scaleLabel:{display:!0,labelString:this.yAxisLabel,fontSize:16,fontColor:"white"}}],xAxes:[{type:"time",time:{unit:"hour",displayFormats:{day:"YYYY-MM-DD HH:mm:ss",hour:"YYYY-MM-DD HH:mm:ss"}},gridLines:{color:"#313131"},ticks:{autoskip:!0,autoSkipPadding:33,maxRotation:0,minRotation:0,fontColor:"white"},scaleLabel:{display:!0,labelString:this.xAxisLabel,fontSize:16,fontColor:"white"},getValueForPixel(){}}]},annotation:{drawTime:"afterDraw",annotations:[{type:"line",id:"line",mode:"horizontal",scaleID:"y-axis-0",value:2,borderWidth:2,borderColor:"red"}]},legend:{display:!1}},xlabels:[],datasets:[],isDark:!0,currentTheme:"dark",colors:["blue","green","red","orange","pink","grey","black","seagreen"],time_window_style:{width:"100px",left:"100px",backgroundColor:"white"},time_window_left_property:100,time_window_width:100,ori_time_window_width:100,lastOffsetOFTimeWindow:0,isTimeWindowClickDown:!1,isRightBoundClickDown:!1,isAdjustWindowSizeMode:!1,bound_ori_mouse_x:-1}},methods:{ThemeChange(){this.currentTheme="dark"==this.currentTheme?"light":"dark",this.chart_style.backgroundColor="dark"==this.currentTheme?"#202020":"white",this.chart_style.border="dark"==this.currentTheme?"1px solid grey":"1px solid white",this.isDark="dark"==this.currentTheme,this.chartInstance.options.title.fontColor=this.chartInstance.options.scales.xAxes[0].ticks.fontColor=this.chartInstance.options.scales.xAxes[0].scaleLabel.fontColor=this.chartInstance.options.scales.yAxes[0].ticks.fontColor=this.chartInstance.options.scales.yAxes[0].scaleLabel.fontColor="dark"==this.currentTheme?"white":"black",this.chartInstance.update()},ChartInit(){this.xlabelUseTimeFormat||(this.options.scales.xAxes[0].type="category");const e=document.getElementById("preview_chart_"+this.chart_id);this.preview_chartInstance=new(Z())(e,{type:"line",data:{labels:[],datasets:[]},options:this.options}),this.preview_chartInstance.options.animation=!1},PreviewChartEventRegist(){this.TimeWindowDom.addEventListener("mousedown",(e=>this.TimeWindowMouseDown(e))),this.TimeWindowDom.addEventListener("mouseup",(e=>this.TimeWindowMouseUp(e))),this.TimeWindowDom.addEventListener("mousemove",(e=>this.TimeWindowMouseMove(e))),document.getElementById("preview_chart_"+this.chart_id).addEventListener("mouseup",(e=>this.TimeWindowMouseUp(e))),document.getElementById("preview_chart_"+this.chart_id).addEventListener("mousemove",(e=>this.TimeWindowMouseMove(e))),document.getElementById("preview_chart_"+this.chart_id).addEventListener("mousedown",(e=>{if(!this.isAdjustWindowSizeMode){var t=this.preview_chartInstance.scales["x-axis-0"].left;this.time_window_left_property=e.x-50<=t?t:e.x-25-50,this.time_window_style.left=this.time_window_left_property+"px"}})),document.getElementById("preview-region").addEventListener("mousemove",(e=>{if(this.isRightBoundClickDown){console.log("adjust width",e);var t=e.x-this.bound_ori_mouse_x;this.time_window_width=this.ori_time_window_width+t,this.time_window_style.width=this.time_window_width+"px"}})),document.getElementById("preview-region").addEventListener("mouseup",(()=>{this.isRightBoundClickDown=!1})),document.getElementById("preview-region").addEventListener("mousedown",(e=>{this.ori_time_window_width=this.time_window_width,this.bound_ori_mouse_x=e.x})),document.getElementById("right-bound").addEventListener("mousedown",(()=>{this.isRightBoundClickDown=!0})),document.getElementById("right-bound").addEventListener("mouseup",(()=>this.isRightBoundClickDown=!1)),document.getElementById("right-bound").addEventListener("mousemove",(e=>{this.isRightBoundClickDown&&console.log("adjust width",e)}))},async UpdatePreviewChart(e=[],t=[]){this.PreviewChartEventRegist(),console.info("開始渲染"),this.preview_chartInstance.data.labels=e,this.preview_chartInstance.data.datasets=[{label:"preview",data:Object.values(t),borderColor:"white",backgroundColor:"rgb(27, 90, 181)",borderWidth:1,fill:"end",pointStyle:"none",pointRadius:0,lineTension:0}],this.preview_chartInstance.update(),console.info("結束渲染")},ShowPreviewChart(){this.PreviewShow=!0},HidePreviewChart(){this.PreviewShow=!1},Clear(){this.preview_chartInstance.data.datasets=[],this.preview_chartInstance.data.labels=[],this.preview_chartInstance.update()},async RenderData(e,t){await new Promise(((a,s)=>{try{this.chartInstance.data.datasets=t,this.chartInstance.data.labels=e,this.chartInstance.update(),console.info("結束渲染"),a()}catch(o){console.error(o),this.ChartInit(),s(o)}}))},TimeWindowMouseDown(e){this.isAdjustWindowSizeMode||(this.isTimeWindowClickDown=!0,this.lastOffsetOFTimeWindow=e.offsetX,this.time_window_style.backgroundColor="red")},TimeWindowMouseUp(){if(this.isTimeWindowClickDown=!1,this.time_window_style.backgroundColor="white",!this.isAdjustWindowSizeMode){var e=V()(this.preview_chartInstance.scales["x-axis-0"].getValueForPixel(this.time_window_left_property).toString()).format("yyyy/MM/DD HH:mm:ss"),t=V()(this.preview_chartInstance.scales["x-axis-0"].getValueForPixel(this.time_window_left_property+this.time_window_width).toString()).format("yyyy/MM/DD HH:mm:ss");this.$emit("DateTimeIntervalOnchanged",{from:e,to:t})}},TimeWindowMouseMove(e){if(!this.isAdjustWindowSizeMode&&this.isTimeWindowClickDown){var t=this.preview_chartInstance.scales["x-axis-0"].left;this.time_window_left_property=e.x<=t?t:e.x-25,this.time_window_style.left=this.time_window_left_property+"px"}}},computed:{TimeWindowDom(){return document.getElementById("time-window")}},mounted(){this.ChartInit()},created(){}};const Co=(0,G.Z)(ko,[["render",Do]]);var xo=Co;const Io={id:"database-setting",class:"d-flex flex-column w-100 h-100 mx-0 my-0 px-0"},Wo=(0,l._)("div",{class:"w-100"},null,-1),To={class:"w-100 flex-fill"},jo=(0,l._)("h5",null,"IDMS DATABASE",-1),Po={class:"d-flex flex-row"},Mo=(0,l._)("div",{class:"property-name"},"IDMS Database",-1),Ao=(0,l._)("h5",null,"DB BASIC",-1),Eo={class:"d-flex flex-row"},zo=(0,l._)("div",{class:"property-name"},"HOST",-1),Ro={class:"d-flex flex-row"},Lo=(0,l._)("div",{class:"property-name"},"PORT",-1),Ho={class:"d-flex flex-row"},Uo=(0,l._)("div",{class:"property-name"},"User Name",-1),No={class:"d-flex flex-row"},Vo=(0,l._)("div",{class:"property-name"},"Password",-1),Oo=(0,l._)("h5",null,"連線測試",-1),Fo={class:"d-flex"},Qo=(0,l.Uk)("TEST"),$o=(0,l._)("div",{class:"w-100 bg-dark",style:{height:"1px"}},null,-1);function Bo(e,t,a,s,o,n){const i=(0,l.up)("el-option"),r=(0,l.up)("el-select"),d=(0,l.up)("el-divider"),c=(0,l.up)("el-input"),u=(0,l.up)("b-button");return(0,l.wg)(),(0,l.iD)("div",Io,[Wo,(0,l._)("div",To,[jo,(0,l._)("div",Po,[Mo,(0,l.Wm)(r,{class:"w-100",modelValue:o.IDMSDBNAME,"onUpdate:modelValue":t[0]||(t[0]=e=>o.IDMSDBNAME=e)},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o.DataBaseList,(e=>((0,l.wg)(),(0,l.j4)(i,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,l.Wm)(d),Ao,(0,l._)("div",Eo,[zo,(0,l.Wm)(c,{class:"w-100",modelValue:o.Host,"onUpdate:modelValue":t[1]||(t[1]=e=>o.Host=e)},null,8,["modelValue"])]),(0,l._)("div",Ro,[Lo,(0,l.Wm)(c,{class:"w-100",modelValue:o.Port,"onUpdate:modelValue":t[2]||(t[2]=e=>o.Port=e)},null,8,["modelValue"])]),(0,l._)("div",Ho,[Uo,(0,l.Wm)(c,{class:"w-100",modelValue:o.UserName,"onUpdate:modelValue":t[3]||(t[3]=e=>o.UserName=e)},null,8,["modelValue"])]),(0,l._)("div",No,[Vo,(0,l.Wm)(c,{"show-password":"",class:"w-100",modelValue:o.Password,"onUpdate:modelValue":t[4]||(t[4]=e=>o.Password=e)},null,8,["modelValue"])]),(0,l.Wm)(d),Oo,(0,l._)("div",Fo,[(0,l.Wm)(u,{variant:"light"},{default:(0,l.w5)((()=>[Qo])),_:1})])]),$o])}async function Yo(){return await Ko("/api/PostgrelDB/Databases")}async function Zo(){return await Ko("/api/Query/ModuleInfos")}async function qo(e,t,a){return await Ko(`/api/Query/HealthScore?ip=${e}&from=${t}&to=${a}`)}async function Go(e,t,a){return await Ko(`/api/Query/AlertIndex?ip=${e}&from=${t}&to=${a}`)}async function Jo(e,t,a){return await Ko(`/api/Query/HealthScoreSplice?queryID=${e}&from=${t}&to=${a}`)}async function Ko(e=""){return new Promise((t=>{P().get(e).catch((e=>{console.info(e),t({message:e.message})})).then((e=>{t(e.data)}))}))}P().defaults.baseURL=f.host;var Xo={data(){return{IDMSDBNAME:"",Host:"127.0.0.1",Port:"5432",UserName:"postgres",Password:"changeme",DataBaseList:[]}},mounted(){setTimeout((async()=>{this.DataBaseList=await Yo()}),12)}};const en=(0,G.Z)(Xo,[["render",Bo]]);var tn=en,an={components:{GPMChart:K,GPMPreviewChart:xo,DatabaseSetting:tn},data(){return{DatabaseList:[],ModuleList:[],QueryOptions:{SelectedEQ:"",SelectedUNIT:"",SelectedQueryItem:"",TimeRange:[]},QueryItems:["Raw Data","Health Score","Alert Index"],loading:!1,chart_loading:!1,showSettingPnl:!1,chart_key:"",ServerResponseData:{count:0,dbConnected:!0,message:"",timeList:[],valueList:[],QueryID:"-"}}},computed:{EQList(){var e=[];return this.ModuleList.forEach((t=>{e.includes(t.EQ)||e.push(t.EQ)})),e},UNITS_IN_EQ(){return this.ModuleList.filter((e=>e.EQ==this.QueryOptions.SelectedEQ))},StartTime(){return V()(this.QueryOptions.TimeRange[0]).format("yyyy/MM/DD HH:mm:ss")},EndTime(){return V()(this.QueryOptions.TimeRange[1]).format("yyyy/MM/DD HH:mm:ss")},Ylabel(){return"Raw Data"==this.QueryOptions.SelectedQueryItem?"G":"Health Score"==this.QueryOptions.SelectedQueryItem?"Score":"Alert Index"==this.QueryOptions.SelectedQueryItem?"Index":""}},methods:{async FetchModuleList(){this.ModuleList=await rs().catch((async e=>{console.info("IDMS websocket連接失敗,從資料庫調取模組資訊",e);var t=await Zo();return t})),console.info(this.ModuleList)},async QueryHandle(){this.SaveQueryOptionsToLocalStorage(),this.loading=!0,new Promise((()=>{this.$refs.query_chart.Clear(),"Health Score"==this.QueryOptions.SelectedQueryItem?qo(this.QueryOptions.SelectedUNIT,this.StartTime,this.EndTime).then((e=>{this.RenderChart(e)})):"Alert Index"==this.QueryOptions.SelectedQueryItem?Go(this.QueryOptions.SelectedUNIT,this.StartTime,this.EndTime).then((e=>{this.RenderChart(e)})):this.loading=!1}))},SaveQueryOptionsToLocalStorage(){localStorage.setItem("query-options",JSON.stringify(this.QueryOptions))},ReadQueryOptionsFromLocalStorage(){var e=localStorage.getItem("query-options");e&&(this.QueryOptions=JSON.parse(e))},async RenderChart(e){this.ServerResponseData=e,null!=e.preview?this.RenderPreviewChart(e.preview):(this.$refs.preview_chart.HidePreviewChart(),this.RenderFullChart(e)),this.loading=!1},async GetSliceDataHandle(e={}){this.chart_loading=!0;var t=await Jo(this.ServerResponseData.QueryID,e.from,e.to);await this.RenderFullChart(t),this.chart_loading=!1},async RenderFullChart(e,t=!1){await new Promise((a=>{var s=[];e.valueList.forEach((e=>{s.push({label:e.labelName,data:e.valueList,borderColor:e.displayColor})})),this.$refs.query_chart.UpdateChart(e.timeList,s,t),a()}))},async RenderPreviewChart(e){await new Promise((t=>{this.$refs.preview_chart.UpdatePreviewChart(e.TimeLs,e.DataLs),this.$refs.preview_chart.ShowPreviewChart(),t()}))}},async mounted(){this.FetchModuleList().then((()=>{this.ReadQueryOptionsFromLocalStorage()})),this.DatabaseList=await Yo()}};const sn=(0,G.Z)(an,[["render",_o]]);var on=sn,nn=[{path:"/",name:"SSM",component:ot},{path:"/admin",name:"ADMIN",component:Wa}],ln=[{path:"/",name:"診斷頁面",component:Ns},{path:"/idms/module-states",name:"感測器狀態",component:Bs},{path:"/idms/query",name:"Query",component:on}],rn=[{path:"/",name:"SSM",component:ot},{path:"/admin",name:"ADMIN",component:Wa},{path:"/idms",name:"診斷頁面",component:Ns},{path:"/idms/module-states",name:"感測器狀態",component:Bs},{path:"/idms/query",name:"Query",component:on}];const dn="dev"==f.mode?rn:"gmm"==f.mode?nn:ln,cn=(0,b.p7)({history:(0,b.PO)(),routes:dn});function un(){return dn}var hn=cn,mn={data(){return{breadcrumbItems:[{text:"SSM",href:"/"},{text:"Log",href:"/log"},{text:"Library"}]}},computed:{mode(){return f.mode},routes(){return un()}}};const pn=(0,G.Z)(mn,[["render",y]]);var wn=pn,gn=a(9907);(0,gn.z)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var _n=a(8212);const yn=(0,s.ri)(wn);yn.use(f),yn.use(hn),yn.use(o.ZP),yn.use(_n.Z),yn.use(n.Z,{size:"default",zIndex:3e3});for(const[fn,bn]of Object.entries(i))yn.component(fn,bn);yn.mount("#app")}},t={};function a(s){var o=t[s];if(void 0!==o)return o.exports;var n=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(n.exports,n,n.exports,a),n.loaded=!0,n.exports}a.m=e,function(){var e=[];a.O=function(t,s,o,n){if(!s){var i=1/0;for(c=0;c<e.length;c++){s=e[c][0],o=e[c][1],n=e[c][2];for(var l=!0,r=0;r<s.length;r++)(!1&n||i>=n)&&Object.keys(a.O).every((function(e){return a.O[e](s[r])}))?s.splice(r--,1):(l=!1,n<i&&(i=n));if(l){e.splice(c--,1);var d=o();void 0!==d&&(t=d)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[s,o,n]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var o,n,i=s[0],l=s[1],r=s[2],d=0;if(i.some((function(t){return 0!==e[t]}))){for(o in l)a.o(l,o)&&(a.m[o]=l[o]);if(r)var c=r(a)}for(t&&t(s);d<i.length;d++)n=i[d],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(c)},s=self["webpackChunkgpm_admin"]=self["webpackChunkgpm_admin"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(7449)}));s=a.O(s)})();
//# sourceMappingURL=app.11e101e2.js.map